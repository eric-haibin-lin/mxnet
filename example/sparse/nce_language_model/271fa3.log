2018-03-05 14:38:46,238 Namespace(batch_size=128, bptt=20, checkpoint_dir='./checkpoint/', checkpoint_interval=1, clip=1.0, data='/home/ubuntu/gbw/training-monolingual.tokenized.shuffled/*', dense=False, dropout=0.01, emsize=512, epochs=8, eps=0.0001, gpus='0,1,2,3', k=8192, kvstore='device', load_epoch=-1, log_interval=10000, lr=0.05, nhid=2048, nlayers=1, num_proj=512, per_ctx_clip=True, profile=False, rescale_embed=True, seed=1, test='/home/ubuntu/gbw-validation/heldout-monolingual.tokenized.shuffled/news.en.heldout-00000-of-00050', vocab='./data/1b_word_vocab.txt')
2018-03-05 14:38:46,238 ['train.py', '--data=/home/ubuntu/gbw/training-monolingual.tokenized.shuffled/*', '--gpus=0,1,2,3', '--per-ctx-clip', '--clip=1', '--lr=0.05', '--dropout=0.01', '--eps=0.0001', '--epoch=8', '--checkpoint-interval=1', '--log-interval=10000', '--rescale-embed', '--test=/home/ubuntu/gbw-validation/heldout-monolingual.tokenized.shuffled/news.en.heldout-00000-of-00050']
[14:38:48] src/operator/tensor/./../../common/utils.h:416: _SparseEmbedding_backward with deterministic=True may reduce speed significantly
2018-03-05 14:38:57,167 ['lstmp0_i2h_weight', 'lstmp0_i2h_bias', 'lstmp0_h2h_weight', 'lstmp0_h2h_bias', 'lstmp0_h2r_weight']
train.py:93: UserWarning: Optimizer created manually outside Module but rescale_grad is not normalized to 1.0/batch_size/num_workers (0.25 vs. 0.001953125). Is this intended?
  module.init_optimizer(optimizer=optimizer, kvstore=kvstore)
[14:38:57] src/kvstore/./kvstore_local.h:279: Warning: non-default weights detected during kvstore pull. This call has been ignored. Please make sure to use row_sparse_pull with row_ids.
[14:38:57] src/kvstore/./kvstore_local.h:279: Warning: non-default weights detected during kvstore pull. This call has been ignored. Please make sure to use row_sparse_pull with row_ids.
2018-03-05 14:38:57,168 Training started ... 
/home/ubuntu/pr/python/mxnet/ndarray/ndarray.py:1905: RuntimeWarning: You are attempting to copy an array to itself
  warnings.warn('You are attempting to copy an array to itself', RuntimeWarning)
2018-03-05 14:49:06,392 Iter[0] Batch [10000]	Speed: 169635.83 samples/sec
2018-03-05 14:49:06,392 Iter[0] Batch [10000] 	loss 5.9916694, ppl 400.0819395
2018-03-05 14:59:05,864 Iter[0] Batch [20000]	Speed: 170817.09 samples/sec
2018-03-05 14:59:05,864 Iter[0] Batch [20000] 	loss 5.3871975, ppl 218.5899281
2018-03-05 15:09:04,030 Iter[0] Batch [30000]	Speed: 171190.02 samples/sec
2018-03-05 15:09:04,030 Iter[0] Batch [30000] 	loss 5.2358431, ppl 187.8874522
2018-03-05 15:18:59,415 Iter[0] Batch [40000]	Speed: 171989.51 samples/sec
2018-03-05 15:18:59,415 Iter[0] Batch [40000] 	loss 5.1475766, ppl 172.0141193
2018-03-05 15:28:55,763 Iter[0] Batch [50000]	Speed: 171711.90 samples/sec
2018-03-05 15:28:55,763 Iter[0] Batch [50000] 	loss 5.0880556, ppl 162.0744220
2018-03-05 15:38:53,823 Iter[0] Batch [60000]	Speed: 171220.22 samples/sec
2018-03-05 15:38:53,824 Iter[0] Batch [60000] 	loss 5.0451594, ppl 155.2690432
2018-03-05 15:48:50,927 Iter[0] Batch [70000]	Speed: 171494.52 samples/sec
2018-03-05 15:48:50,927 Iter[0] Batch [70000] 	loss 5.0104516, ppl 149.9724428
2018-03-05 15:57:11,930 Saved checkpoint to "./checkpoint/-0000.params"
2018-03-05 15:59:49,686 eval batch 19 : 4.1828265
2018-03-05 16:02:33,852 eval batch 39 : 4.1747481
2018-03-05 16:05:18,449 eval batch 59 : 4.1911273
2018-03-05 16:06:14,689 Iter[0]		 CE loss 3.9544632, ppl 52.1676824. Time cost = 541.45 seconds
2018-03-05 16:16:18,804 Iter[1] Batch [10000]	Speed: 170105.61 samples/sec
2018-03-05 16:16:18,804 Iter[1] Batch [10000] 	loss 4.9216403, ppl 137.2275247
2018-03-05 16:26:16,503 Iter[1] Batch [20000]	Speed: 171323.59 samples/sec
2018-03-05 16:26:16,503 Iter[1] Batch [20000] 	loss 4.8970437, ppl 133.8933718
2018-03-05 16:36:12,168 Iter[1] Batch [30000]	Speed: 171908.69 samples/sec
2018-03-05 16:36:12,169 Iter[1] Batch [30000] 	loss 4.8860838, ppl 132.4339128
2018-03-05 16:46:03,316 Iter[1] Batch [40000]	Speed: 173222.39 samples/sec
2018-03-05 16:46:03,316 Iter[1] Batch [40000] 	loss 4.8872978, ppl 132.5947935
2018-03-05 16:55:55,017 Iter[1] Batch [50000]	Speed: 173060.47 samples/sec
2018-03-05 16:55:55,017 Iter[1] Batch [50000] 	loss 4.8716747, ppl 130.5393466
2018-03-05 17:05:48,702 Iter[1] Batch [60000]	Speed: 172481.98 samples/sec
2018-03-05 17:05:48,703 Iter[1] Batch [60000] 	loss 4.8580681, ppl 128.7751841
2018-03-05 17:15:43,508 Iter[1] Batch [70000]	Speed: 172157.05 samples/sec
2018-03-05 17:15:43,508 Iter[1] Batch [70000] 	loss 4.8513066, ppl 127.9073997
2018-03-05 17:24:02,942 Saved checkpoint to "./checkpoint/-0000.params"
2018-03-05 17:26:41,184 eval batch 19 : 4.0449869
2018-03-05 17:29:25,924 eval batch 39 : 4.0426811
2018-03-05 17:32:11,464 eval batch 59 : 4.0605458
2018-03-05 17:33:06,943 Iter[1]		 CE loss 3.8314062, ppl 46.1273584. Time cost = 542.68 seconds
2018-03-05 17:42:59,212 Iter[2] Batch [10000]	Speed: 173518.22 samples/sec
2018-03-05 17:42:59,212 Iter[2] Batch [10000] 	loss 4.7916706, ppl 120.5025151
2018-03-05 17:52:54,018 Iter[2] Batch [20000]	Speed: 172156.88 samples/sec
2018-03-05 17:52:54,018 Iter[2] Batch [20000] 	loss 4.7807634, ppl 119.1953135
2018-03-05 18:02:51,591 Iter[2] Batch [30000]	Speed: 171359.93 samples/sec
2018-03-05 18:02:51,591 Iter[2] Batch [30000] 	loss 4.7793856, ppl 119.0311978
2018-03-05 18:12:43,382 Iter[2] Batch [40000]	Speed: 173034.20 samples/sec
2018-03-05 18:12:43,382 Iter[2] Batch [40000] 	loss 4.7844522, ppl 119.6358071
2018-03-05 18:22:39,690 Iter[2] Batch [50000]	Speed: 171723.18 samples/sec
2018-03-05 18:22:39,691 Iter[2] Batch [50000] 	loss 4.7793222, ppl 119.0236470
2018-03-05 18:32:36,025 Iter[2] Batch [60000]	Speed: 171715.61 samples/sec
2018-03-05 18:32:36,026 Iter[2] Batch [60000] 	loss 4.7762078, ppl 118.6535393
2018-03-05 18:42:28,502 Iter[2] Batch [70000]	Speed: 172833.78 samples/sec
2018-03-05 18:42:28,502 Iter[2] Batch [70000] 	loss 4.7725931, ppl 118.2254181
2018-03-05 18:50:48,107 Saved checkpoint to "./checkpoint/-0000.params"
2018-03-05 18:53:25,608 eval batch 19 : 3.9819025
2018-03-05 18:56:09,889 eval batch 39 : 3.9785816
2018-03-05 18:58:53,597 eval batch 59 : 3.9974115
2018-03-05 18:59:48,822 Iter[2]		 CE loss 3.7722877, ppl 43.4794170. Time cost = 539.39 seconds
2018-03-05 19:09:43,821 Iter[3] Batch [10000]	Speed: 172718.38 samples/sec
2018-03-05 19:09:43,821 Iter[3] Batch [10000] 	loss 4.7217872, ppl 112.3688976
2018-03-05 19:19:36,889 Iter[3] Batch [20000]	Speed: 172661.49 samples/sec
2018-03-05 19:19:36,889 Iter[3] Batch [20000] 	loss 4.7175569, ppl 111.8945461
2018-03-05 19:29:32,061 Iter[3] Batch [30000]	Speed: 172051.10 samples/sec
2018-03-05 19:29:32,061 Iter[3] Batch [30000] 	loss 4.7200463, ppl 112.1734406
2018-03-05 19:39:24,515 Iter[3] Batch [40000]	Speed: 172840.38 samples/sec
2018-03-05 19:39:24,516 Iter[3] Batch [40000] 	loss 4.7222278, ppl 112.4184211
2018-03-05 19:49:18,844 Iter[3] Batch [50000]	Speed: 172295.35 samples/sec
2018-03-05 19:49:18,844 Iter[3] Batch [50000] 	loss 4.7218534, ppl 112.3763423
2018-03-05 19:59:12,035 Iter[3] Batch [60000]	Speed: 172625.68 samples/sec
2018-03-05 19:59:12,035 Iter[3] Batch [60000] 	loss 4.7250572, ppl 112.7369453
2018-03-05 20:09:02,905 Iter[3] Batch [70000]	Speed: 173303.82 samples/sec
2018-03-05 20:09:02,905 Iter[3] Batch [70000] 	loss 4.7220409, ppl 112.3974148
2018-03-05 20:17:21,557 Saved checkpoint to "./checkpoint/-0000.params"
2018-03-05 20:20:00,104 eval batch 19 : 3.9606500
2018-03-05 20:22:43,356 eval batch 39 : 3.9565747
2018-03-05 20:25:27,027 eval batch 59 : 3.9748846
2018-03-05 20:26:22,402 Iter[3]		 CE loss 3.7505177, ppl 42.5431028. Time cost = 539.52 seconds
2018-03-05 20:36:15,049 Iter[4] Batch [10000]	Speed: 173410.79 samples/sec
2018-03-05 20:36:15,049 Iter[4] Batch [10000] 	loss 4.6719662, ppl 106.9077433
2018-03-05 20:46:07,807 Iter[4] Batch [20000]	Speed: 172751.90 samples/sec
2018-03-05 20:46:07,807 Iter[4] Batch [20000] 	loss 4.6743425, ppl 107.1620849
2018-03-05 20:55:59,665 Iter[4] Batch [30000]	Speed: 173014.38 samples/sec
2018-03-05 20:55:59,665 Iter[4] Batch [30000] 	loss 4.6808191, ppl 107.8583792
2018-03-05 21:05:50,237 Iter[4] Batch [40000]	Speed: 173391.33 samples/sec
2018-03-05 21:05:50,237 Iter[4] Batch [40000] 	loss 4.6816816, ppl 107.9514471
2018-03-05 21:15:46,170 Iter[4] Batch [50000]	Speed: 171831.50 samples/sec
2018-03-05 21:15:46,170 Iter[4] Batch [50000] 	loss 4.6822103, ppl 108.0085416
2018-03-05 21:25:40,113 Iter[4] Batch [60000]	Speed: 172406.98 samples/sec
2018-03-05 21:25:40,114 Iter[4] Batch [60000] 	loss 4.6810641, ppl 107.8848077
2018-03-05 21:35:32,135 Iter[4] Batch [70000]	Speed: 172966.55 samples/sec
2018-03-05 21:35:32,136 Iter[4] Batch [70000] 	loss 4.6847197, ppl 108.2799158
2018-03-05 21:43:50,250 Saved checkpoint to "./checkpoint/-0000.params"
2018-03-05 21:46:30,186 eval batch 19 : 3.9556415
2018-03-05 21:49:14,752 eval batch 39 : 3.9500413
2018-03-05 21:51:59,390 eval batch 59 : 3.9684250
2018-03-05 21:52:54,734 Iter[4]		 CE loss 3.7444353, ppl 42.2851223. Time cost = 543.15 seconds
2018-03-05 22:02:47,012 Iter[5] Batch [10000]	Speed: 173513.07 samples/sec
2018-03-05 22:02:47,012 Iter[5] Batch [10000] 	loss 4.6366344, ppl 103.1964419
2018-03-05 22:12:42,044 Iter[5] Batch [20000]	Speed: 172091.71 samples/sec
2018-03-05 22:12:42,044 Iter[5] Batch [20000] 	loss 4.6435866, ppl 103.9163826
2018-03-05 22:22:32,841 Iter[5] Batch [30000]	Speed: 173325.31 samples/sec
2018-03-05 22:22:32,841 Iter[5] Batch [30000] 	loss 4.6462200, ppl 104.1904006
2018-03-05 22:32:23,255 Iter[5] Batch [40000]	Speed: 173437.58 samples/sec
2018-03-05 22:32:23,255 Iter[5] Batch [40000] 	loss 4.6481375, ppl 104.3903773
2018-03-05 22:42:17,427 Iter[5] Batch [50000]	Speed: 172340.68 samples/sec
2018-03-05 22:42:17,427 Iter[5] Batch [50000] 	loss 4.6495997, ppl 104.5431273
2018-03-05 22:52:09,461 Iter[5] Batch [60000]	Speed: 172963.03 samples/sec
2018-03-05 22:52:09,462 Iter[5] Batch [60000] 	loss 4.6536812, ppl 104.9706986
2018-03-05 23:02:01,318 Iter[5] Batch [70000]	Speed: 173014.92 samples/sec
2018-03-05 23:02:01,318 Iter[5] Batch [70000] 	loss 4.6516181, ppl 104.7543541
2018-03-05 23:10:19,222 Saved checkpoint to "./checkpoint/-0000.params"
2018-03-05 23:12:58,189 eval batch 19 : 3.9454629
2018-03-05 23:15:41,576 eval batch 39 : 3.9406332
2018-03-05 23:18:26,587 eval batch 59 : 3.9592929
2018-03-05 23:19:22,369 Iter[5]		 CE loss 3.7357977, ppl 41.9214511. Time cost = 541.82 seconds
2018-03-05 23:29:16,067 Iter[6] Batch [10000]	Speed: 173094.71 samples/sec
2018-03-05 23:29:16,067 Iter[6] Batch [10000] 	loss 4.6104547, ppl 100.5298489
2018-03-05 23:39:09,159 Iter[6] Batch [20000]	Speed: 172654.50 samples/sec
2018-03-05 23:39:09,159 Iter[6] Batch [20000] 	loss 4.6107369, ppl 100.5582212
2018-03-05 23:49:04,175 Iter[6] Batch [30000]	Speed: 172096.12 samples/sec
2018-03-05 23:49:04,176 Iter[6] Batch [30000] 	loss 4.6175516, ppl 101.2458343
2018-03-05 23:58:54,340 Iter[6] Batch [40000]	Speed: 173511.10 samples/sec
2018-03-05 23:58:54,340 Iter[6] Batch [40000] 	loss 4.6230859, ppl 101.8077201
2018-03-06 00:08:46,062 Iter[6] Batch [50000]	Speed: 173054.03 samples/sec
2018-03-06 00:08:46,063 Iter[6] Batch [50000] 	loss 4.6258419, ppl 102.0886828
2018-03-06 00:18:39,512 Iter[6] Batch [60000]	Speed: 172550.51 samples/sec
2018-03-06 00:18:39,512 Iter[6] Batch [60000] 	loss 4.6261028, ppl 102.1153251
2018-03-06 00:28:31,437 Iter[6] Batch [70000]	Speed: 172994.83 samples/sec
2018-03-06 00:28:31,438 Iter[6] Batch [70000] 	loss 4.6275191, ppl 102.2600484
2018-03-06 00:36:49,716 Saved checkpoint to "./checkpoint/-0000.params"
2018-03-06 00:39:27,499 eval batch 19 : 3.9419898
2018-03-06 00:42:10,844 eval batch 39 : 3.9353690
2018-03-06 00:44:54,194 eval batch 59 : 3.9545727
2018-03-06 00:45:49,092 Iter[6]		 CE loss 3.7310671, ppl 41.7236087. Time cost = 538.04 seconds
